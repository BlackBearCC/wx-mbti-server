# å¾®ä¿¡å°ç¨‹åºAIèŠå¤©å®¤åç«¯APIè§„æ ¼æ–‡æ¡£

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

åŸºäºå¾®ä¿¡å°ç¨‹åºçš„AIèŠå¤©å®¤äº§å“ï¼Œé‡‡ç”¨å¤šç»´åº¦MBTIè§’è‰²ç”Ÿæ€ç³»ç»Ÿã€‚ç”¨æˆ·å¯ä»¥åœ¨ä¸åŒä¸»é¢˜èŠå¤©å®¤ä¸­ä¸64ç§ä¸åŒæ€§æ ¼èƒŒæ™¯çš„AIè§’è‰²äº’åŠ¨ï¼Œé€šè¿‡"è®¤åŒ"æœºåˆ¶å’Œè¯é¢˜äº’åŠ¨æå‡è§’è‰²æŠ€èƒ½ï¼Œè§£é”æ›´å¤šè§’è‰²å’ŒæŠ€èƒ½ï¼Œåˆ›é€ ä¸ªæ€§åŒ–çš„AIä¼™ä¼´æˆé•¿ä½“éªŒã€‚

---

## ğŸ—ï¸ æ ¸å¿ƒåŠŸèƒ½æ¶æ„
### èŠå¤©å®¤ç³»ç»Ÿ
- **å¤šä¸»é¢˜èŠå¤©å®¤**ï¼šé‡‘èæŠ•èµ„ã€å¨±ä¹ä¼‘é—²ã€æ¯æ—¥è®°äº‹ç­‰ä¸»é¢˜
- **AIè§’è‰²é…ç½®**ï¼šæ¯ä¸ªèŠå¤©å®¤åŒ…å«3-5ä¸ªä¸åŒä¸“ä¸šçš„AIè§’è‰²
- **åŠ¨æ€äº¤äº’**ï¼šåŸºäºç”¨æˆ·è®¤åŒåº¦çš„AIæ´»è·ƒåº¦è°ƒèŠ‚æœºåˆ¶
### å¤šç»´åº¦MBTIè§’è‰²ç³»ç»Ÿ
- **16ç§MBTIç»´åº¦**ï¼šæ¯ç§æ€§æ ¼ç±»å‹å¯¹åº”4ä¸ªä¸åŒèƒŒæ™¯çš„è§’è‰²ï¼Œå…±64ä¸ªè§’è‰²
- **è§’è‰²ç¤ºä¾‹**ï¼š
  ```
  INTJç»´åº¦ï¼ˆ4ä¸ªè§’è‰²ï¼‰ï¼š
  â”œâ”€â”€ ğŸ”¬ ç§‘å­¦å®¶ (ç†æ€§ç ”ç©¶å‹) - å…è´¹åŸºç¡€è§’è‰²
  â”œâ”€â”€ ğŸ—ï¸ å»ºç­‘å¸ˆ (è®¾è®¡åˆ›é€ å‹) - ä»˜è´¹è§’è‰² Â¥12
  â”œâ”€â”€ ğŸ’» ç¨‹åºå‘˜ (æŠ€æœ¯é€»è¾‘å‹) - VIPä¸“å±
  â””â”€â”€ ğŸ¯ æˆ˜ç•¥å®¶ (è§„åˆ’å†³ç­–å‹) - é™å®šè§’è‰² Â¥68
  
  ENFPç»´åº¦ï¼ˆ4ä¸ªè§’è‰²ï¼‰ï¼š
  â”œâ”€â”€ ğŸ¨ è‰ºæœ¯å®¶ (åˆ›æ„è¡¨è¾¾å‹) - å…è´¹åŸºç¡€è§’è‰²
  â”œâ”€â”€ ğŸ“º ä¸»æ’­ (ç¤¾äº¤å¨±ä¹å‹) - ä»˜è´¹è§’è‰² Â¥18
  â”œâ”€â”€ ğŸ­ æ¼”å‘˜ (è¡¨æ¼”è‰ºæœ¯å‹) - VIPä¸“å±
  â””â”€â”€ ğŸŒŸ åˆ›æ„æ€»ç›‘ (é¢†å¯¼åˆ›æ–°å‹) - é™å®šè§’è‰² Â¥88
  ```

### æ™ºèƒ½æŠ€èƒ½æˆé•¿ç³»ç»Ÿ
- **å¤©èµ‹æŠ€èƒ½**ï¼šæ¯ä¸ªè§’è‰²çš„åˆå§‹ä¸“é•¿ï¼Œä¸åŒç­‰çº§è§£é”ä¸åŒèƒ½åŠ›
- **å­¦ä¹ æŠ€èƒ½**ï¼šé€šè¿‡åœ¨èŠå¤©å®¤äº’åŠ¨ã€è¯é¢˜åŒ¹é…åº¦ã€è·å¾—è®¤åŒç­‰æ–¹å¼ä¹ å¾—
- **æŠ€èƒ½å‡çº§**ï¼šåŸºäºè¯é¢˜ç›¸å…³æ€§è‡ªåŠ¨ç§¯ç´¯ç»éªŒå€¼ï¼Œæˆ–ä»˜è´¹å¿«é€Ÿå‡çº§

### è®¤åŒä¸æˆé•¿æœºåˆ¶
- **è®¤åŒç³»ç»Ÿ**ï¼šç”¨æˆ·å¯¹AIå›å¤è¿›è¡Œè®¤åŒï¼Œå½±å“è§’è‰²æ´»è·ƒåº¦å’ŒæŠ€èƒ½ç»éªŒ
- **è¯é¢˜åŒ¹é…**ï¼šAIå›å¤ä¸èŠå¤©è¯é¢˜ç›¸å…³æ€§è¶Šé«˜ï¼ŒæŠ€èƒ½ç»éªŒæå‡è¶Šå¤š
- **æˆé•¿è¿½è¸ª**ï¼šè¯¦ç»†è®°å½•æ¯ä¸ªè§’è‰²çš„æŠ€èƒ½è¿›åº¦å’Œè§£é”çŠ¶æ€

---

## ğŸ‘¤ ç”¨æˆ·è´¦å·ç³»ç»Ÿ

### ç”¨æˆ·æ³¨å†Œç™»å½•

#### å¾®ä¿¡ç™»å½•æµç¨‹
```
1. å°ç¨‹åºè°ƒç”¨ wx.login() è·å– code
2. å‰ç«¯è¯·æ±‚: POST /api/auth/wxlogin
3. åç«¯é€šè¿‡ code è·å– openid å’Œ session_key
4. è¿”å›è‡ªå®šä¹‰ token å’Œç”¨æˆ·ä¿¡æ¯
```

#### å¾®ä¿¡ç™»å½•æ¥å£
```http
POST /api/auth/wxlogin
Content-Type: application/json

Request:
{
  "code": "string",           // å¾®ä¿¡ç™»å½•å‡­è¯
  "nickName": "string",       // ç”¨æˆ·æ˜µç§°
  "avatarUrl": "string",      // ç”¨æˆ·å¤´åƒURL
  "gender": 0,                // æ€§åˆ« 0æœªçŸ¥ 1ç”· 2å¥³
  "country": "string",        // å›½å®¶
  "province": "string",       // çœä»½
  "city": "string"           // åŸå¸‚
}

Response:
{
  "code": 200,
  "message": "ç™»å½•æˆåŠŸ",
  "data": {
    "token": "jwt_token_string",
    "expiresIn": 7200,         // tokenè¿‡æœŸæ—¶é—´(ç§’)
    "user": {
      "userId": "string",
      "openid": "string",
      "nickName": "string",
      "avatarUrl": "string",
      "userLevel": "normal",    // normal|vip|premium
      "createTime": "timestamp",
      "lastLoginTime": "timestamp",
      "isNewUser": true         // æ˜¯å¦æ–°ç”¨æˆ·
    },
    "defaultCharacters": [     // æ–°ç”¨æˆ·é»˜è®¤è§£é”çš„16ä¸ªå…è´¹è§’è‰²
      {
        "characterId": "intj_scientist_001",
        "dimension": "INTJ",
        "name": "è‰¾ç±³Â·ç§‘å­¦å®¶",
        "isDefault": true
      }
    ]
  }
}
```

### ç”¨æˆ·ä¿¡æ¯ç®¡ç†

#### è·å–ç”¨æˆ·ä¿¡æ¯
```http
GET /api/user/profile
Authorization: Bearer {token}

Response:
{
  "code": 200,
  "data": {
    "userId": "string",
    "openid": "string",
    "nickName": "string", 
    "avatarUrl": "string",
    "gender": 0,
    "country": "string",
    "province": "string", 
    "city": "string",
    "userLevel": "normal",      // ç”¨æˆ·ç­‰çº§
    "totalMessages": 156,       // æ€»æ¶ˆæ¯æ•°
    "totalLikes": 89,          // è·å¾—çš„æ€»è®¤åŒæ•°
    "ownedCharacters": 18,     // æ‹¥æœ‰è§’è‰²æ•°é‡
    "totalSkillLevel": 156,    // æ‰€æœ‰æŠ€èƒ½ç­‰çº§æ€»å’Œ
    "joinedRooms": [           // å·²åŠ å…¥æˆ¿é—´
      {
        "roomId": "finance_room",
        "joinTime": "timestamp",
        "lastActiveTime": "timestamp"
      }
    ],
    "favoriteCharacters": [    // æ”¶è—çš„è§’è‰²
      {
        "characterId": "intj_scientist_001",
        "name": "è‰¾ç±³Â·ç§‘å­¦å®¶",
        "level": 15,
        "totalSkillLevel": 23
      }
    ],
    "createTime": "timestamp",
    "lastLoginTime": "timestamp"
  }
}
```

#### æ›´æ–°ç”¨æˆ·ä¿¡æ¯
```http
PUT /api/user/profile
Authorization: Bearer {token}
Content-Type: application/json

Request:
{
  "nickName": "string",       // å¯é€‰
  "avatarUrl": "string",      // å¯é€‰
  "gender": 1                 // å¯é€‰
}

Response:
{
  "code": 200,
  "message": "æ›´æ–°æˆåŠŸ",
  "data": {
    "user": {...}             // æ›´æ–°åçš„ç”¨æˆ·ä¿¡æ¯
  }
}
```

### ç”¨æˆ·ç­‰çº§ç³»ç»Ÿ

#### ç­‰çº§è§„åˆ™
- **normal**ï¼šæ™®é€šç”¨æˆ·ï¼ŒåŸºç¡€åŠŸèƒ½
- **vip**ï¼šVIPç”¨æˆ·ï¼Œé«˜çº§AIè§’è‰²ã€æ›´å¤šèŠå¤©æ¬¡æ•°
- **premium**ï¼šé«˜çº§ç”¨æˆ·ï¼Œæ‰€æœ‰åŠŸèƒ½ã€ä¸“å±AIè§’è‰²

#### è·å–ç”¨æˆ·ç»Ÿè®¡
```http
GET /api/user/stats
Authorization: Bearer {token}

Response:
{
  "code": 200,
  "data": {
    "userId": "string",
    "userLevel": "normal",
    "currentLevelExp": 1250,    // å½“å‰ç­‰çº§ç»éªŒ
    "nextLevelExp": 2000,       // å‡çº§æ‰€éœ€ç»éªŒ
    "statistics": {
      "totalMessages": 156,     // æ€»å‘è¨€æ•°
      "totalLikes": 89,         // æ€»è®¤åŒæ•°  
      "totalDays": 15,          // ä½¿ç”¨å¤©æ•°
      "roomsCount": 3,          // å‚ä¸æˆ¿é—´æ•°
      "favoriteAICount": 2      // æ”¶è—AIæ•°é‡
    },
    "achievements": [           // æˆå°±åˆ—è¡¨
      {
        "achievementId": "first_message",
        "name": "åˆå‡ºèŒ…åº",
        "description": "å‘é€ç¬¬ä¸€æ¡æ¶ˆæ¯",
        "unlockTime": "timestamp"
      }
    ],
    "weeklyStats": {            // æœ¬å‘¨ç»Ÿè®¡
      "messagesCount": 25,
      "likesReceived": 12,
      "likesGiven": 18,
      "activeHours": 5.5
    }
  }
}
```

### Tokenç®¡ç†

#### åˆ·æ–°Token
```http
POST /api/auth/refresh
Authorization: Bearer {token}

Response:
{
  "code": 200,
  "data": {
    "token": "new_jwt_token",
    "expiresIn": 7200
  }
}
```

#### é€€å‡ºç™»å½•
```http
POST /api/auth/logout
Authorization: Bearer {token}

Response:
{
  "code": 200,
  "message": "é€€å‡ºæˆåŠŸ"
}
```

---

## ğŸ¤– å¤šç»´åº¦è§’è‰²ç³»ç»Ÿ

### è§’è‰²æ•°æ®ç»“æ„
```json
{
  "characterId": "intj_scientist_001",
  "dimension": "INTJ",        // MBTIç»´åº¦
  "name": "è‰¾ç±³Â·ç§‘å­¦å®¶",
  "englishName": "Amy Scientist",
  "avatar": "/static/characters/intj_scientist.svg",
  "background": "ç§‘å­¦å®¶",
  "backgroundStory": "æ¯•ä¸šäºæ–¯å¦ç¦å¤§å­¦çš„æ•°æ®ç§‘å­¦åšå£«ï¼Œä¸“æ³¨äºå¤æ‚ç³»ç»Ÿåˆ†æ...",
  "rarity": "common",         // common|rare|epic|legendary
  "unlockType": "free",       // free|paid|vip|limited
  "price": 0,                 // 0=å…è´¹, >0=ä»˜è´¹ä»·æ ¼
  
  "personality": {
    "traits": ["ç†æ€§", "ç‹¬ç«‹", "è¿½æ±‚çœŸç†", "å®Œç¾ä¸»ä¹‰"],
    "catchphrase": "æ•°æ®ä¸ä¼šæ’’è°ï¼Œä½†è§£è¯»æ•°æ®éœ€è¦æ™ºæ…§",
    "communication": "é€»è¾‘æ¸…æ™°ï¼Œå–œæ¬¢ç”¨äº‹å®å’Œæ•°æ®è¯´è¯",
    "quirks": ["å–œæ¬¢ç”¨æ¯”å–»è§£é‡Šå¤æ‚æ¦‚å¿µ", "å¶å°”ä¼šé™·å…¥æ€è€ƒå¿˜è®°å›å¤"]
  },
  
  "talents": [                // å¤©èµ‹æŠ€èƒ½ï¼ˆåˆå§‹æ‹¥æœ‰ï¼‰
    {
      "skillId": "data_analysis",
      "skillName": "æ•°æ®åˆ†æ",
      "level": 1,
      "maxLevel": 10,
      "experience": 0,
      "description": "å¤©ç”Ÿæ“…é•¿åˆ†æå¤æ‚æ•°æ®å’Œå‘ç°è§„å¾‹",
      "effects": {
        "level1": "åŸºç¡€æ•°æ®è§£è¯»èƒ½åŠ›",
        "level5": "é«˜çº§ç»Ÿè®¡åˆ†æèƒ½åŠ›", 
        "level10": "é¢„æµ‹å»ºæ¨¡å¤§å¸ˆçº§èƒ½åŠ›"
      }
    },
    {
      "skillId": "logical_reasoning", 
      "skillName": "é€»è¾‘æ¨ç†",
      "level": 1,
      "maxLevel": 10,
      "experience": 0,
      "description": "ä¸¥å¯†çš„é€»è¾‘æ€ç»´å’Œæ¨ç†èƒ½åŠ›"
    }
  ],
  
  "learnableSkills": [         // å¯å­¦ä¹ æŠ€èƒ½
    {
      "skillId": "investment_analysis", 
      "skillName": "æŠ•èµ„åˆ†æ",
      "level": 0,
      "maxLevel": 10,
      "experience": 0,
      "unlockCondition": {
        "type": "topic_interaction",
        "topics": ["æŠ•èµ„", "è‚¡ç¥¨", "åŸºé‡‘", "ç†è´¢"],
        "requirement": 50,       // éœ€è¦åœ¨ç›¸å…³è¯é¢˜äº’åŠ¨50æ¬¡
        "description": "åœ¨æŠ•èµ„ç›¸å…³è¯é¢˜ä¸­ç§¯æäº’åŠ¨"
      },
      "upgradeConditions": [
        {
          "level": 2,
          "requirements": [
            {"type": "topic_experience", "value": 100},
            {"type": "likes_received", "value": 20}
          ],
          "fastUpgrade": {"cost": 6, "currency": "CNY"}
        },
        {
          "level": 5,
          "requirements": [
            {"type": "topic_experience", "value": 500},
            {"type": "likes_received", "value": 100},
            {"type": "consecutive_days", "value": 7}
          ],
          "fastUpgrade": {"cost": 18, "currency": "CNY"}
        }
      ]
    },
    {
      "skillId": "game_strategy",
      "skillName": "æ¸¸æˆç­–ç•¥", 
      "level": 0,
      "maxLevel": 10,
      "experience": 0,
      "unlockCondition": {
        "type": "room_interaction",
        "roomId": "entertainment_room",
        "requirement": 30,
        "description": "åœ¨å¨±ä¹ä¼‘é—²å®¤äº’åŠ¨30æ¬¡"
      }
    }
  ],
  
  "statistics": {
    "totalMessages": 1256,
    "totalLikes": 890,
    "averageResponseTime": 2.5,
    "userRating": 4.8,
    "topicExpertise": {         // è¯é¢˜ä¸“é•¿åº¦
      "investment": 0.85,
      "technology": 0.92,
      "science": 0.95,
      "gaming": 0.45
    }
  },
  
  "isEnabled": true,
  "createTime": "timestamp",
  "updateTime": "timestamp"
}
```

### æŠ€èƒ½ç»éªŒè®¡ç®—ç³»ç»Ÿ
```json
{
  "experienceRules": {
    "topicMatch": {
      "description": "åŸºäºè¯é¢˜åŒ¹é…åº¦è·å¾—ç»éªŒ",
      "calculation": "messageLength * topicRelevance * difficultyMultiplier",
      "factors": {
        "topicRelevance": "0.1-1.0 (AIåˆ¤æ–­å›å¤ä¸æŠ€èƒ½è¯é¢˜çš„ç›¸å…³åº¦)",
        "difficultyMultiplier": "1.0-2.0 (å¤æ‚è¯é¢˜è·å¾—æ›´å¤šç»éªŒ)",
        "baseExperience": "1-10 (æ ¹æ®æ¶ˆæ¯é•¿åº¦å’Œè´¨é‡)"
      }
    },
    "userInteraction": {
      "like": 5,              // æ¯ä¸ªè®¤åŒ+5ç»éªŒ
      "reply": 3,             // ç”¨æˆ·å›å¤+3ç»éªŒ
      "mention": 8,           // è¢«@æåŠ+8ç»éªŒ
      "consecutive": 1.2      // è¿ç»­å¯¹è¯ä¹˜æ•°
    },
    "roomBonus": {
      "description": "ç‰¹å®šæˆ¿é—´å†…ç›¸å…³æŠ€èƒ½ç»éªŒåŠ æˆ",
      "finance_room": {
        "investment_analysis": 1.5,
        "data_analysis": 1.2
      },
      "entertainment_room": {
        "game_strategy": 1.5,
        "social_interaction": 1.3
      }
    }
  }
}
```

### HTTP APIæ¥å£

#### è·å–ç”¨æˆ·è§’è‰²åº“
```http
GET /api/user/characters
Authorization: Bearer {token}

Response:
{
  "code": 200,
  "data": {
    "ownedCharacters": [
      {
        "characterId": "intj_scientist_001",
        "dimension": "INTJ",
        "name": "è‰¾ç±³Â·ç§‘å­¦å®¶",
        "level": 15,
        "experience": 2580,
        "nextLevelExp": 3000,
        "avatar": "/static/characters/intj_scientist.svg",
        "talents": [...],
        "learnedSkills": [...],
        "isActive": true        // æ˜¯å¦æ­£åœ¨ä½¿ç”¨
      }
    ],
    "availableCharacters": [   // å¯è§£é”ä½†æœªæ‹¥æœ‰çš„è§’è‰²
      {
        "characterId": "intj_architect_002", 
        "dimension": "INTJ",
        "name": "å¤§å«Â·å»ºç­‘å¸ˆ",
        "unlockType": "paid",
        "price": 12,
        "preview": {...}       // é¢„è§ˆä¿¡æ¯
      }
    ],
    "lockedCharacters": [      // æš‚æœªæ»¡è¶³è§£é”æ¡ä»¶çš„è§’è‰²
      {
        "characterId": "intj_strategist_004",
        "name": "è‰è‰Â·æˆ˜ç•¥å®¶",
        "unlockCondition": "VIPç­‰çº§",
        "preview": {...}
      }
    ]
  }
}
```

#### è·å–è§’è‰²è¯¦æƒ…
```http
GET /api/characters/{characterId}
Authorization: Bearer {token}

Response:
{
  "code": 200,
  "data": {
    "character": {
      "characterId": "intj_scientist_001",
      "dimension": "INTJ",
      "name": "è‰¾ç±³Â·ç§‘å­¦å®¶",
      "avatar": "/static/characters/intj_scientist.svg",
      "background": "ç§‘å­¦å®¶",
      "backgroundStory": "...",
      "personality": {...},
      "talents": [...],
      "learnableSkills": [...],
      "statistics": {...}
    },
    "userProgress": {          // ç”¨æˆ·å¯¹æ­¤è§’è‰²çš„ä½¿ç”¨æƒ…å†µ
      "level": 15,
      "experience": 2580,
      "nextLevelExp": 3000,
      "skillProgress": [
        {
          "skillId": "investment_analysis",
          "level": 3,
          "experience": 245,
          "nextLevelExp": 300,
          "canUpgrade": true,
          "fastUpgradeCost": 6
        }
      ],
      "recentAchievements": [
        "æŠ•èµ„åˆ†æå¸ˆ", "è¿ç»­å¯¹è¯7å¤©", "è·å¾—100ä¸ªè®¤åŒ"
      ]
    }
  }
}
```

#### è§’è‰²å•†åº—
```http
GET /api/shop/characters?dimension=INTJ&category=paid&page=1&pageSize=12
Authorization: Bearer {token}

Query Parameters:
- dimension: INTJ|ENFP|ISTP|... (MBTIç»´åº¦ç­›é€‰)
- category: all|free|paid|vip|limited (ç±»åˆ«ç­›é€‰)
- rarity: all|common|rare|epic|legendary (ç¨€æœ‰åº¦ç­›é€‰)
- sort: price|popularity|newest (æ’åºæ–¹å¼)

Response:
{
  "code": 200,
  "data": {
    "characters": [
      {
        "characterId": "intj_architect_002",
        "dimension": "INTJ", 
        "name": "å¤§å«Â·å»ºç­‘å¸ˆ",
        "avatar": "/static/characters/intj_architect.svg",
        "background": "å»ºç­‘å¸ˆ",
        "rarity": "rare",
        "unlockType": "paid",
        "price": 12,
        "originalPrice": 18,   // åŸä»·ï¼ˆå¦‚æœ‰æŠ˜æ‰£ï¼‰
        "discount": 0.33,      // æŠ˜æ‰£
        "preview": {
          "talents": ["ç©ºé—´è®¾è®¡", "ç¾å­¦æ„ŸçŸ¥"],
          "specialSkills": ["å»ºç­‘åˆ†æ", "è®¾è®¡æ€ç»´"],
          "sampleDialogue": "è®©æˆ‘ä»¬ä»ç»“æ„å’Œç¾å­¦çš„è§’åº¦æ¥åˆ†æè¿™ä¸ªé—®é¢˜..."
        },
        "popularity": 4.8,     // ç”¨æˆ·è¯„åˆ†
        "purchaseCount": 1256, // è´­ä¹°äººæ•°
        "isHot": true,         // æ˜¯å¦çƒ­é—¨
        "isNew": false,        // æ˜¯å¦æ–°å“
        "tags": ["è®¾è®¡", "åˆ›æ„", "ä¸“ä¸š"]
      }
    ],
    "pagination": {
      "page": 1,
      "pageSize": 12,
      "total": 48,
      "hasMore": true
    },
    "recommendations": [      // ä¸ªæ€§åŒ–æ¨è
      "åŸºäºæ‚¨å–œæ¬¢INTJ-ç§‘å­¦å®¶ï¼Œæ¨èINTJ-ç¨‹åºå‘˜"
    ]
  }
}
```

#### è§£é”/è´­ä¹°è§’è‰²
```http
POST /api/characters/unlock
Authorization: Bearer {token}
Content-Type: application/json

Request:
{
  "characterId": "intj_architect_002",
  "unlockType": "purchase",   // purchase|free_unlock
  "paymentMethod": "wechat_pay", // å¾®ä¿¡æ”¯ä»˜
  "couponId": "coupon_123"    // ä¼˜æƒ åˆ¸IDï¼ˆå¯é€‰ï¼‰
}

Response:
{
  "code": 200,
  "message": "è§’è‰²è§£é”æˆåŠŸ",
  "data": {
    "characterId": "intj_architect_002",
    "unlockTime": "timestamp",
    "paymentInfo": {
      "orderId": "order_123456",
      "amount": 12,
      "actualAmount": 8,     // ä½¿ç”¨ä¼˜æƒ åˆ¸åçš„å®é™…æ”¯ä»˜é‡‘é¢
      "paymentMethod": "wechat_pay"
    },
    "character": {...}       // å®Œæ•´è§’è‰²ä¿¡æ¯
  }
}
```

#### æŠ€èƒ½å‡çº§
```http
POST /api/skills/upgrade
Authorization: Bearer {token}
Content-Type: application/json

Request:
{
  "characterId": "intj_scientist_001",
  "skillId": "investment_analysis",
  "upgradeType": "natural|fast",  // è‡ªç„¶å‡çº§æˆ–ä»˜è´¹å¿«é€Ÿå‡çº§
  "paymentMethod": "wechat_pay"   // ä»…å¿«é€Ÿå‡çº§éœ€è¦
}

Response:
{
  "code": 200,
  "message": "æŠ€èƒ½å‡çº§æˆåŠŸ", 
  "data": {
    "skillId": "investment_analysis",
    "oldLevel": 2,
    "newLevel": 3,
    "newAbilities": [
      "è§£é”æœŸè´§åˆ†æèƒ½åŠ›",
      "æå‡æŠ•èµ„å»ºè®®è´¨é‡20%"
    ],
    "nextLevelRequirement": {
      "experience": 500,
      "likes": 50,
      "fastUpgradeCost": 12
    }
  }
}
```

#### è·å–æŠ€èƒ½è¿›åº¦
```http
GET /api/skills/progress/{characterId}
Authorization: Bearer {token}

Response:
{
  "code": 200,
  "data": {
    "characterId": "intj_scientist_001",
    "skillProgress": [
      {
        "skillId": "investment_analysis",
        "skillName": "æŠ•èµ„åˆ†æ",
        "level": 3,
        "experience": 245,
        "nextLevelExp": 300,
        "progress": 81.7,      // å‡çº§è¿›åº¦ç™¾åˆ†æ¯”
        "canUpgrade": false,
        "upgradeRequirements": [
          {
            "type": "topic_experience",
            "current": 245,
            "required": 300,
            "description": "æŠ•èµ„è¯é¢˜ç»éªŒå€¼"
          },
          {
            "type": "likes_received", 
            "current": 45,
            "required": 50,
            "description": "è·å¾—è®¤åŒæ•°"
          }
        ],
        "fastUpgrade": {
          "available": true,
          "cost": 12,
          "currency": "CNY"
        },
        "recentActivity": [
          {
            "date": "2024-01-15",
            "experienceGained": 15,
            "source": "é‡‘èæŠ•èµ„å®¤å¯¹è¯",
            "details": "è®¨è®ºè‚¡ç¥¨æŠ•èµ„ç­–ç•¥è·å¾—15ç‚¹ç»éªŒ"
          }
        ]
      }
    ]
  }
}
```

---

## ğŸ–¼ï¸ é¦–é¡µå†…å®¹æ¥å£

### é¦–é¡µå±•ç¤ºéœ€æ±‚
- **å¡ç‰‡ Cards**ï¼šå±•ç¤ºçƒ­é—¨èŠå¤©å®¤/åŠŸèƒ½å…¥å£ï¼ŒåŒ…å«å›¾æ ‡ã€æ ‡é¢˜ã€èƒŒæ™¯æ¸å˜ç­‰ä¿¡æ¯ï¼Œå¯ç‚¹å‡»è·³è½¬ã€‚
- **è½®æ’­ Swipers**ï¼šé¦–é¡µé¡¶éƒ¨æ¨ªå¹…ï¼Œæ”¯æŒè·³è½¬æŒ‡å®šèŠå¤©å®¤æˆ–å¤–éƒ¨é“¾æ¥ã€‚

### æ•°æ®ç»“æ„ç¤ºä¾‹
```json
{
  "card": {
    "id": "finance_room",          // å”¯ä¸€æ ‡è¯†ï¼ˆé€šå¸¸ä¸ roomId ç›¸åŒï¼‰
    "title": "é‡‘èæŠ•èµ„",             // æ ‡é¢˜
    "icon": "ğŸ’°",                  // Emoji æˆ–å›¾æ ‡ URL
    "background": "linear-gradient(135deg, #667eea 0%, #764ba2 100%)", // èƒŒæ™¯
    "description": "ä¸“ä¸šé‡‘èåˆ†æï¼ŒæŠ•èµ„ç†è´¢å»ºè®®",   // æè¿°
    "roomId": "finance_room",      // è·³è½¬çš„èŠå¤©å®¤ IDï¼ˆå¯é€‰ï¼‰
    "targetUrl": ""                // è‹¥è·³è½¬å¤–é“¾åˆ™å¡«å†™
  },
  "swiper": {
    "id": "banner_finance_001",    // å”¯ä¸€æ ‡è¯†
    "imageUrl": "/static/banners/finance.png",  // å›¾ç‰‡ URLï¼ˆå»ºè®® 750Ã—300ï¼‰
    "title": "æŠ•èµ„çƒ­é—¨è¯é¢˜",        // æ ‡é¢˜ï¼ˆå¯é€‰ï¼Œç”¨äºæ— å›¾æ ‡æ—¶è¦†ç›–æ–‡å­—ï¼‰
    "jumpType": "room",            // room|url|none
    "roomId": "finance_room",      // å½“ jumpType=room æ—¶å¿…å¡«
    "targetUrl": ""                // å½“ jumpType=url æ—¶å¿…å¡«
  }
}
```

### HTTP APIæ¥å£

#### è·å–é¦–é¡µå¡ç‰‡åˆ—è¡¨
```http
GET /home/cards

Response:
{
  "code": 200,
  "data": {
    "cards": [
      {
        "id": "finance_room",
        "title": "é‡‘èæŠ•èµ„",
        "icon": "ğŸ’°",
        "background": "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
        "description": "ä¸“ä¸šé‡‘èåˆ†æï¼ŒæŠ•èµ„ç†è´¢å»ºè®®",
        "roomId": "finance_room"
      },
      {
        "id": "entertainment_room",
        "title": "å¨±ä¹ä¼‘é—²",
        "icon": "ğŸ®",
        "background": "linear-gradient(135deg, #f093fb 0%, #f5576c 100%)",
        "description": "è½»æ¾èŠå¤©ï¼Œå¨±ä¹äº’åŠ¨",
        "roomId": "entertainment_room"
      }
    ]
  }
}
```

#### è·å–é¦–é¡µè½®æ’­å›¾åˆ—è¡¨
```http
GET /home/swipers

Response:
{
  "code": 200,
  "data": {
    "swipers": [
      {
        "id": "banner_finance_001",
        "imageUrl": "/static/banners/finance.png",
        "title": "æŠ•èµ„çƒ­é—¨è¯é¢˜",
        "jumpType": "room",
        "roomId": "finance_room"
      },
      {
        "id": "banner_outside_001",
        "imageUrl": "/static/banners/promo.png",
        "jumpType": "url",
        "targetUrl": "https://example.com/activity"
      }
    ]
  }
}
```

> **è¯´æ˜ï¼š**
> 1. ä¸¤ä¸ªæ¥å£å‡ä¸º *æ— é‰´æƒ* å…¬å¼€æ¥å£ï¼Œé¦–é¡µé¦–æ¬¡åŠ è½½å³è°ƒç”¨ï¼›å¦‚éœ€ç°åº¦ã€AB æµ‹è¯•ï¼Œå¯åœ¨è¿”å›ç»“æ„ä¸­å¢åŠ  `experimentId`ã€‚
> 2. è‹¥å¸Œæœ›åœ¨åå°åŠ¨æ€æ§åˆ¶æ’åºï¼Œå¯åœ¨è¿”å›æ•°ç»„ä¸­æŒ‰ä¸šåŠ¡æ’åºè¿”å›å³å¯ã€‚
> 3. å‰ç«¯ç¼“å­˜æœ¬åœ° 5 åˆ†é’Ÿï¼Œåç»­è‡ªåŠ¨åˆ·æ–°ã€‚

---

## ğŸ  èŠå¤©å®¤ç®¡ç†

### æˆ¿é—´æ•°æ®ç»“æ„
```json
{
  "roomId": "finance_room",
  "name": "é‡‘èæŠ•èµ„", 
  "description": "ä¸“ä¸šé‡‘èåˆ†æï¼ŒæŠ•èµ„ç†è´¢å»ºè®®",
  "icon": "ğŸ’°",
  "background": "linear-gradient(135deg, #667eea 0%, #764ba2 100%)",
  "category": "finance",       // æˆ¿é—´åˆ†ç±»
  "relatedSkills": [           // æˆ¿é—´ç›¸å…³æŠ€èƒ½
    "investment_analysis",
    "data_analysis", 
    "risk_management",
    "market_research"
  ],
  "skillBonusMultiplier": {    // æŠ€èƒ½ç»éªŒåŠ æˆ
    "investment_analysis": 1.5,
    "data_analysis": 1.2,
    "risk_management": 1.3
  },
  "settings": {
    "maxMembers": 50,
    "allowGuestJoin": true,    // æ˜¯å¦å…è®¸æ¸¸å®¢åŠ å…¥
    "moderationLevel": "low",  // å®¡æ ¸ç­‰çº§
    "aiResponseDelay": 2000    // AIå“åº”å»¶è¿Ÿ(æ¯«ç§’)
  },
  "statistics": {
    "totalMembers": 156,       // æ€»æˆå‘˜æ•°
    "activeCharacters": 23,    // æ´»è·ƒè§’è‰²æ•°
    "skillEvolutionCount": 45  // æŠ€èƒ½è¿›åŒ–æ¬¡æ•°
  },
  "isActive": true,
  "createTime": "timestamp",
  "updateTime": "timestamp"
}
```

### HTTP APIæ¥å£

#### è·å–æˆ¿é—´åˆ—è¡¨
```http
GET /api/rooms?category=all&page=1&pageSize=10&sort=popularity
Authorization: Bearer {token}

Response:
{
  "code": 200,
  "data": {
    "rooms": [
      {
        "roomId": "finance_room",
        "name": "é‡‘èæŠ•èµ„",
        "description": "ä¸“ä¸šé‡‘èåˆ†æï¼ŒæŠ•èµ„ç†è´¢å»ºè®®", 
        "icon": "ğŸ’°",
        "background": "linear-gradient(...)",
        "category": "finance",
        "activeCharacters": [   // å½“å‰æˆ¿é—´æ´»è·ƒçš„è§’è‰²
          {
            "characterId": "intj_scientist_001",
            "dimension": "INTJ",
            "avatar": "/static/characters/intj_scientist_mini.svg",
            "level": 15
          },
          {
            "characterId": "estj_manager_001",
            "dimension": "ESTJ", 
            "avatar": "/static/characters/estj_manager_mini.svg",
            "level": 12
          }
        ],
        "skillOpportunities": [  // å¯æå‡æŠ€èƒ½æç¤º
          "æŠ•èµ„åˆ†æ", "æ•°æ®åˆ†æ", "é£é™©ç®¡ç†"
        ],
        "lastActivity": "timestamp",
        "isJoined": true,          // å½“å‰ç”¨æˆ·æ˜¯å¦å·²åŠ å…¥
        "requireLevel": "normal"   // æ‰€éœ€ç”¨æˆ·ç­‰çº§
      }
    ],
    "pagination": {
      "page": 1,
      "pageSize": 10,
      "total": 25,
      "hasMore": true
    }
  }
}
```

#### è·å–æˆ¿é—´è¯¦æƒ…
```http
GET /api/rooms/{roomId}
Authorization: Bearer {token}

Response:
{
  "code": 200, 
  "data": {
    "room": {
      "roomId": "finance_room",
      "name": "é‡‘èæŠ•èµ„",
      "description": "ä¸“ä¸šé‡‘èåˆ†æï¼ŒæŠ•èµ„ç†è´¢å»ºè®®",
      "icon": "ğŸ’°", 
      "background": "linear-gradient(...)",
      "category": "finance",
      "activeCharacters": [
        {
          "characterId": "intj_scientist_001",
          "dimension": "INTJ",
          "avatar": "/static/characters/intj_scientist.svg", 
          "level": 15
        }
      ],
      "settings": {...},
      "statistics": {...}
    },
    "userStatus": {
      "isJoined": true,
      "joinTime": "timestamp",
      "messageCount": 25,        // ç”¨æˆ·åœ¨æ­¤æˆ¿é—´çš„æ¶ˆæ¯æ•°
      "likesGiven": 12          // ç”¨æˆ·åœ¨æ­¤æˆ¿é—´ç»™å‡ºçš„è®¤åŒæ•°
    }
  }
}
```

#### è·å–æˆ¿é—´æ¶ˆæ¯å†å²
```http
GET /api/rooms/{roomId}/messages?before=messageId&limit=20
Authorization: Bearer {token}

Query Parameters:
- before: è·å–æ­¤æ¶ˆæ¯IDä¹‹å‰çš„æ¶ˆæ¯ (å¯é€‰ï¼Œç”¨äºåˆ†é¡µ)
- limit: è·å–æ•°é‡ï¼Œé»˜è®¤20ï¼Œæœ€å¤§50

Response:
{
  "code": 200,
  "data": {
    "messages": [
      {
        "messageId": "srv_msg_124",
        "fromType": "user|ai",
        "fromUser": {
          "userId": "user123",
          "nickName": "å¼ ä¸‰",
          "avatarUrl": "xxx"
        },
        "aiInfo": {             // å½“fromType=aiæ—¶å­˜åœ¨
          "characterId": "intj_scientist_001", 
          "name": "è‰¾ç±³Â·ç§‘å­¦å®¶",
          "avatar": "/static/characters/intj_scientist.svg"
        },
        "content": "ä»Šå¤©è‚¡å¸‚æ€ä¹ˆæ ·ï¼Ÿ",
        "replyToMessageId": "srv_msg_123",
        "mentions": ["intj_scientist_001"],
        "likes": [
          {
            "userId": "user456",
            "nickName": "æå››", 
            "timestamp": 1234567890
          }
        ],
        "totalLikes": 5,
        "isLikedByMe": true,    // å½“å‰ç”¨æˆ·æ˜¯å¦å·²è®¤åŒ
        "timestamp": 1234567890
      }
    ],
    "hasMore": true,
    "nextCursor": "srv_msg_100"
  }
}
```

#### åŠ å…¥/é€€å‡ºæˆ¿é—´
```http
POST /api/rooms/{roomId}/join
Authorization: Bearer {token}

Response:
{
  "code": 200,
  "message": "åŠ å…¥æˆåŠŸ",
  "data": {
    "roomId": "finance_room",
    "joinTime": "timestamp"
  }
}
```

```http
POST /api/rooms/{roomId}/leave  
Authorization: Bearer {token}

Response:
{
  "code": 200,
  "message": "é€€å‡ºæˆåŠŸ"
}
```

---

## ğŸ’° å•†ä¸šåŒ–ç³»ç»Ÿ

### ä»˜è´¹æ¨¡å¼è®¾è®¡
```json
{
  "monetization": {
    "characterPurchase": {
      "freeCharacters": 16,    // æ¯ä¸ªMBTIç»´åº¦1ä¸ªå…è´¹è§’è‰²
      "paidCharacters": {
        "rare": {"price": "Â¥12-18", "count": 16},
        "epic": {"price": "Â¥28-38", "count": 16}, 
        "legendary": {"price": "Â¥68-88", "count": 16}
      },
      "bundles": {
        "dimensionPack": "Â¥45 è§£é”æŸä¸ªMBTIç»´åº¦å…¨éƒ¨4ä¸ªè§’è‰²",
        "rarityPack": "Â¥150 è§£é”æ‰€æœ‰rareçº§åˆ«è§’è‰²",
        "completePack": "Â¥298 è§£é”æ‰€æœ‰64ä¸ªè§’è‰²"
      }
    },
    
    "skillUpgrade": {
      "naturalUpgrade": "é€šè¿‡äº’åŠ¨å’Œè¯é¢˜åŒ¹é…å…è´¹å‡çº§",
      "fastUpgrade": {
        "level1to5": "Â¥6-18 è·³è¿‡å•çº§å‡çº§æ¡ä»¶",
        "level6to10": "Â¥25-68 è·³è¿‡å•çº§å‡çº§æ¡ä»¶",
        "skillMaxOut": "Â¥88 ç›´æ¥å‡æ»¡æŸä¸ªæŠ€èƒ½"
      },
      "skillPacks": {
        "characterSkillPack": "Â¥128 æŸä¸ªè§’è‰²æ‰€æœ‰æŠ€èƒ½æ»¡çº§",
        "topicSkillPack": "Â¥68 æŸä¸ªè¯é¢˜ç›¸å…³æ‰€æœ‰æŠ€èƒ½æ»¡çº§"
      }
    },
    
    "vipMembership": {
      "monthly": "Â¥30/æœˆ",
      "yearly": "Â¥298/å¹´", 
      "benefits": [
        "è§£é”æ‰€æœ‰VIPä¸“å±è§’è‰²",
        "æŠ€èƒ½å‡çº§è´¹ç”¨8æŠ˜",
        "æ¯æ—¥é¢å¤–ç»éªŒåŠ æˆ20%",
        "ä¸“å±VIPèŠå¤©å®¤",
        "è§’è‰²å½¢è±¡è‡ªå®šä¹‰",
        "ä¼˜å…ˆä½“éªŒæ–°åŠŸèƒ½"
      ]
    },
    
    "limitedOffers": {
      "seasonalCharacters": "Â¥128-188 èŠ‚æ—¥é™å®šè§’è‰²",
      "anniversaryPack": "Â¥168 å‘¨å¹´çºªå¿µç¤¼åŒ…",
      "collaborationCharacters": "Â¥88-148 è”åè§’è‰²"
    }
  }
}
```

### æ”¯ä»˜ç³»ç»Ÿæ¥å£
```http
POST /api/payment/create-order
Authorization: Bearer {token}
Content-Type: application/json

Request:
{
  "productType": "character|skill|vip|bundle",
  "productId": "intj_architect_002",
  "quantity": 1,
  "paymentMethod": "wechat_pay",
  "couponId": "coupon_123",     // å¯é€‰
  "source": "character_store"   // è´­ä¹°æ¥æº
}

Response:
{
  "code": 200,
  "data": {
    "orderId": "order_123456789",
    "productInfo": {
      "name": "å¤§å«Â·å»ºç­‘å¸ˆ",
      "originalPrice": 18,
      "discountPrice": 12,
      "finalPrice": 10         // ä½¿ç”¨ä¼˜æƒ åˆ¸åçš„æœ€ç»ˆä»·æ ¼
    },
    "paymentInfo": {
      "prepayId": "wx_prepay_123",
      "timeStamp": "timestamp",
      "nonceStr": "random_string", 
      "package": "prepay_id=wx_prepay_123",
      "signType": "RSA",
      "paySign": "signature"
    },
    "expireTime": "timestamp"  // è®¢å•è¿‡æœŸæ—¶é—´
  }
}
```

---

## ğŸ’¾ æ•°æ®å­˜å‚¨ç»“æ„

### ç”¨æˆ·è¡¨ (users)
```sql
{
  "userId": "string PRIMARY KEY",
  "openid": "string UNIQUE",
  "unionid": "string",
  "nickName": "string",
  "avatarUrl": "string", 
  "gender": "int",
  "country": "string",
  "province": "string",
  "city": "string",
  "userLevel": "enum(normal,vip,premium)",
  "experience": "int DEFAULT 0",
  "totalMessages": "int DEFAULT 0",
  "totalLikes": "int DEFAULT 0",
  "totalCharacters": "int DEFAULT 16",    // æ‹¥æœ‰è§’è‰²æ•°
  "totalSkillLevel": "int DEFAULT 0",     // æ‰€æœ‰æŠ€èƒ½ç­‰çº§æ€»å’Œ
  "lastLoginTime": "timestamp",
  "createTime": "timestamp",
  "updateTime": "timestamp",
  "isDeleted": "boolean DEFAULT false"
}
```

### è§’è‰²å®šä¹‰è¡¨ (character_definitions)
```sql
{
  "characterId": "string PRIMARY KEY",
  "dimension": "string",              // MBTIç»´åº¦
  "name": "string",
  "englishName": "string",
  "avatar": "string",
  "background": "string",
  "backgroundStory": "text",
  "rarity": "enum(common,rare,epic,legendary)",
  "unlockType": "enum(free,paid,vip,limited)",
  "price": "decimal(10,2) DEFAULT 0",
  "personality": "json",              // æ€§æ ¼ç‰¹å¾
  "talents": "json",                  // å¤©èµ‹æŠ€èƒ½
  "learnableSkills": "json",          // å¯å­¦ä¹ æŠ€èƒ½
  "isEnabled": "boolean DEFAULT true",
  "createTime": "timestamp",
  "updateTime": "timestamp"
}
```

### ç”¨æˆ·è§’è‰²è¡¨ (user_characters)
```sql
{
  "id": "string PRIMARY KEY",
  "userId": "string",
  "characterId": "string",
  "level": "int DEFAULT 1",
  "experience": "int DEFAULT 0",
  "unlockTime": "timestamp",
  "unlockType": "enum(default,purchase,gift)",
  "totalMessages": "int DEFAULT 0",
  "totalLikes": "int DEFAULT 0",
  "lastActiveTime": "timestamp",
  "isActive": "boolean DEFAULT false",  // æ˜¯å¦å½“å‰ä½¿ç”¨
  "UNIQUE(userId, characterId)",
  "INDEX(userId, isActive)"
}
```

### æŠ€èƒ½è¿›åº¦è¡¨ (skill_progress)
```sql
{
  "id": "string PRIMARY KEY",
  "userId": "string",
  "characterId": "string",
  "skillId": "string",
  "level": "int DEFAULT 0",
  "experience": "int DEFAULT 0",
  "unlockTime": "timestamp",
  "lastUpgradeTime": "timestamp",
  "totalUsageCount": "int DEFAULT 0",
  "UNIQUE(userId, characterId, skillId)",
  "INDEX(userId, characterId)"
}
```

### æŠ€èƒ½ç»éªŒè®°å½•è¡¨ (skill_experience_log)
```sql
{
  "id": "string PRIMARY KEY",
  "userId": "string",
  "characterId": "string", 
  "skillId": "string",
  "messageId": "string",           // ç›¸å…³æ¶ˆæ¯ID
  "roomId": "string",
  "experienceGained": "int",
  "source": "enum(topic_match,like,mention,room_bonus)",
  "topicRelevance": "float",       // è¯é¢˜ç›¸å…³åº¦
  "createTime": "timestamp",
  "INDEX(userId, characterId, skillId)",
  "INDEX(createTime)"
}
```

### æˆ¿é—´è¡¨ (rooms)
```sql
{
  "roomId": "string PRIMARY KEY",
  "name": "string",
  "description": "text",
  "icon": "string",
  "background": "string", 
  "category": "string",
  "relatedSkills": "json",         // ç›¸å…³æŠ€èƒ½åˆ—è¡¨
  "skillBonusMultiplier": "json",  // æŠ€èƒ½ç»éªŒåŠ æˆ
  "maxMembers": "int DEFAULT 50",
  "settings": "json",
  "totalMembers": "int DEFAULT 0",
  "activeCharacters": "int DEFAULT 0",
  "skillEvolutionCount": "int DEFAULT 0",
  "isActive": "boolean DEFAULT true",
  "createTime": "timestamp",
  "updateTime": "timestamp"
}
```

### æ¶ˆæ¯è¡¨ (messages)
```sql
{
  "messageId": "string PRIMARY KEY",
  "roomId": "string",
  "fromUserId": "string",
  "fromType": "enum(user,ai)",
  "characterId": "string",         // AIè§’è‰²IDï¼ˆå½“fromType=aiæ—¶ï¼‰
  "content": "text", 
  "replyToMessageId": "string",
  "mentions": "json",              // @çš„è§’è‰²IDæ•°ç»„
  "skillsUsed": "json",            // ä½¿ç”¨çš„æŠ€èƒ½åˆ—è¡¨
  "topicRelevance": "float",       // è¯é¢˜ç›¸å…³åº¦
  "experienceGained": "json",      // è·å¾—çš„ç»éªŒåˆ†é…
  "totalLikes": "int DEFAULT 0",
  "createTime": "timestamp",
  "updateTime": "timestamp",
  "isDeleted": "boolean DEFAULT false",
  "INDEX(roomId, createTime)",
  "INDEX(fromUserId, createTime)",
  "INDEX(characterId, createTime)"
}
```

### è®¢å•è¡¨ (orders)
```sql
{
  "orderId": "string PRIMARY KEY",
  "userId": "string",
  "productType": "enum(character,skill,vip,bundle)",
  "productId": "string",
  "productName": "string",
  "originalPrice": "decimal(10,2)",
  "discountPrice": "decimal(10,2)",
  "finalPrice": "decimal(10,2)",
  "paymentMethod": "string",
  "couponId": "string",
  "status": "enum(pending,paid,failed,refunded)",
  "paymentTime": "timestamp",
  "createTime": "timestamp",
  "updateTime": "timestamp",
  "INDEX(userId, status)",
  "INDEX(createTime)"
}
```

---

## âš¡ æ€§èƒ½ä¸é™åˆ¶

### é¢‘ç‡é™åˆ¶
- **ç”¨æˆ·å‘è¨€**ï¼šæ¯åˆ†é’Ÿæœ€å¤š30æ¡æ¶ˆæ¯
- **è®¤åŒæ“ä½œ**ï¼šæ¯ä¸ªæ¶ˆæ¯åªèƒ½è®¤åŒä¸€æ¬¡ï¼Œæ¯åˆ†é’Ÿæœ€å¤š50æ¬¡è®¤åŒ
- **è§’è‰²åˆ‡æ¢**ï¼šæ¯å°æ—¶æœ€å¤š10æ¬¡
- **æŠ€èƒ½å‡çº§**ï¼šæ¯ä¸ªæŠ€èƒ½æ¯å¤©æœ€å¤šå‡çº§3æ¬¡ï¼ˆä»˜è´¹æ— é™åˆ¶ï¼‰

### æ•°æ®é™åˆ¶  
- **æ¶ˆæ¯é•¿åº¦**ï¼šæœ€å¤§1000å­—ç¬¦
- **æˆ¿é—´äººæ•°**ï¼šæœ€å¤§100äººåŒæ—¶åœ¨çº¿
- **åŒæ—¶æ‹¥æœ‰è§’è‰²**ï¼šæ™®é€šç”¨æˆ·64ä¸ªï¼ŒVIPç”¨æˆ·æ— é™åˆ¶
- **æŠ€èƒ½æ•°é‡**ï¼šæ¯ä¸ªè§’è‰²æœ€å¤š20ä¸ªæŠ€èƒ½

### æ€§èƒ½è¦æ±‚
- **WebSocketæ¶ˆæ¯å»¶è¿Ÿ**ï¼š< 100ms
- **HTTP APIå“åº”æ—¶é—´**ï¼š< 500ms
- **AIé¦–æ¬¡å“åº”æ—¶é—´**ï¼š< 3ç§’
- **æŠ€èƒ½ç»éªŒè®¡ç®—**ï¼š< 200ms
- **å¹¶å‘WebSocketè¿æ¥**ï¼šæ”¯æŒ10000+è¿æ¥

---

## ğŸ¯ å¼€å‘ä¼˜å…ˆçº§

### P0ï¼ˆæ ¸å¿ƒåŠŸèƒ½ï¼‰
1. åŸºç¡€MBTIè§’è‰²ç³»ç»Ÿï¼ˆ16ä¸ªå…è´¹è§’è‰²ï¼‰
2. ç”¨æˆ·è®¤è¯å’ŒWebSocketé€šä¿¡
3. æˆ¿é—´ç®¡ç†å’ŒåŸºæœ¬æ¶ˆæ¯æ”¶å‘
4. æŠ€èƒ½ç»éªŒåŸºç¡€è®¡ç®—

### P1ï¼ˆé‡è¦åŠŸèƒ½ï¼‰  
1. ä»˜è´¹è§’è‰²è´­ä¹°ç³»ç»Ÿ
2. æŠ€èƒ½å‡çº§å’Œè§£é”æœºåˆ¶
3. è¯é¢˜åŒ¹é…åº¦ç®—æ³•ä¼˜åŒ–
4. å•†ä¸šåŒ–æ”¯ä»˜ç³»ç»Ÿ

### P2ï¼ˆä¼˜åŒ–åŠŸèƒ½ï¼‰
1. VIPä¼šå‘˜ç³»ç»Ÿ
2. è§’è‰²å•†åº—å’Œæ¨èç³»ç»Ÿ
3. é«˜çº§æŠ€èƒ½ç»„åˆæ•ˆæœ
4. æ•°æ®åˆ†æå’Œè¿è¥åå°

---

**å¤‡æ³¨ï¼šæ­¤æ–‡æ¡£ä¸ºå¤šç»´åº¦MBTIè§’è‰²ç”Ÿæ€ç³»ç»Ÿçš„å®Œæ•´è®¾è®¡è§„èŒƒï¼Œé‡ç‚¹ä½“ç°äº†è§’è‰²å¤šæ ·æ€§ã€æŠ€èƒ½æˆé•¿æœºåˆ¶å’Œå•†ä¸šåŒ–æ¨¡å¼çš„æœ‰æœºç»“åˆã€‚å»ºè®®ä¼˜å…ˆå®ç°P0åŠŸèƒ½ï¼Œç¡®ä¿åŸºç¡€ä½“éªŒåå†é€æ­¥å®Œå–„ä»˜è´¹åŠŸèƒ½ã€‚** 